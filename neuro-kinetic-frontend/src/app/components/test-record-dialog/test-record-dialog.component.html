<p-dialog 
  [(visible)]="visible" 
  [modal]="true" 
  [closable]="true"
  [draggable]="false"
  [resizable]="false"
  [style]="{ width: '600px' }"
  [header]="isEditMode ? 'Edit Test Record' : 'View Test Record'"
  (onHide)="onClose()"
  styleClass="p-fluid">
  
  <form [formGroup]="recordForm" *ngIf="record">
    <div class="grid grid-cols-1 gap-4">
      <!-- User Name -->
      <div>
        <label for="userName" class="block text-sm font-medium mb-2">User Name</label>
        <input 
          pInputText 
          id="userName" 
          formControlName="userName"
          class="w-full"
          readonly />
      </div>

      <!-- Test Date -->
      <div>
        <label for="testDate" class="block text-sm font-medium mb-2">Test Date</label>
        <p-calendar 
          formControlName="testDate"
          [disabled]="true"
          dateFormat="mm/dd/yy"
          [showTime]="true"
          [showButtonBar]="false"
          styleClass="w-full">
        </p-calendar>
      </div>

      <!-- Test Result -->
      <div>
        <label for="testResult" class="block text-sm font-medium mb-2">Test Result</label>
        <p-dropdown 
          formControlName="testResult"
          [options]="testResultOptions"
          optionLabel="label"
          optionValue="value"
          placeholder="Select Result"
          [disabled]="!isEditMode"
          styleClass="w-full">
        </p-dropdown>
      </div>

      <!-- Accuracy -->
      <div>
        <label for="accuracy" class="block text-sm font-medium mb-2">Accuracy (%)</label>
        <input 
          pInputText 
          id="accuracy" 
          type="number"
          formControlName="accuracy"
          [disabled]="!isEditMode"
          min="0"
          max="100"
          class="w-full" />
        <small *ngIf="recordForm.get('accuracy')?.invalid && recordForm.get('accuracy')?.touched" 
               class="p-error">
          Accuracy must be between 0 and 100
        </small>
      </div>

      <!-- Status -->
      <div>
        <label for="status" class="block text-sm font-medium mb-2">Status</label>
        <p-dropdown 
          formControlName="status"
          [options]="statusOptions"
          optionLabel="label"
          optionValue="value"
          placeholder="Select Status"
          [disabled]="!isEditMode"
          styleClass="w-full">
        </p-dropdown>
      </div>

      <!-- Voice Recording URL -->
      <div>
        <label for="voiceRecordingUrl" class="block text-sm font-medium mb-2">Voice Recording URL</label>
        <input 
          pInputText 
          id="voiceRecordingUrl" 
          formControlName="voiceRecordingUrl"
          [disabled]="!isEditMode"
          class="w-full" />
      </div>

      <!-- Analysis Notes -->
      <div>
        <label for="analysisNotes" class="block text-sm font-medium mb-2">Analysis Notes</label>
        <textarea 
          pInputTextarea 
          id="analysisNotes" 
          formControlName="analysisNotes"
          [disabled]="!isEditMode"
          [rows]="4"
          class="w-full">
        </textarea>
      </div>
    </div>
  </form>

  <ng-template pTemplate="footer">
    <p-button 
      label="Cancel" 
      (onClick)="onCancel()" 
      [outlined]="true"
      styleClass="p-button-secondary">
    </p-button>
    <p-button 
      *ngIf="isEditMode"
      label="Save" 
      (onClick)="onSave()" 
      [disabled]="!recordForm.valid"
      [outlined]="true"
      styleClass="p-button-primary">
    </p-button>
  </ng-template>
</p-dialog>

